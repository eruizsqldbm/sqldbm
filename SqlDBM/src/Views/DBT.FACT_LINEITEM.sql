-- ***************************** SqlDBM: Snowflake *****************************
-- * Generated by SqlDBM: dbt + SqlDBM One Project by eric.ruiz+yew@sqldbm.com *

-- ************************************** DBT.FACT_LINEITEM
CREATE VIEW DBT.FACT_LINEITEM
(
  ORDERKEY,
  LINENUMBER,
  PARTKEY,
  SUPPKEY,
  QUANTITY,
  EXTENDEDPRICE,
  DISCOUNT,
  TAX,
  RETURNFLAG,
  LINESTATUS,
  SHIPDATE,
  COMMITDATE,
  RECEIPTDATE,
  SHIPINSTRUCT,
  SHIPMODE,
  SUPPLIERNAME,
  SUPPLIER_ADDRESS,
  SUPPLIER_PHONE,
  PART_NAME,
  PART_KEY,
  PART_MFGR,
  PART_BRAND,
  PART_TYPE,
  PART_SIZE,
  PART_CONTAINER,
  PART_RETAILPRICE,
  CUSTOMER_NAME,
  ADDRESS,
  PHONE,
  LOAD_TIMESTAMP,
  LAST_UPDATED
)
AS
(
    SELECT
    LI.ORDERKEY,
    LI.LINENUMBER,
    LI.PARTKEY,
    LI.SUPPKEY,
    LI.QUANTITY,
    LI.EXTENDEDPRICE,
    LI.DISCOUNT,
    LI.TAX,
    LI.RETURNFLAG,
    LI.LINESTATUS,
    LI.SHIPDATE,
    LI.COMMITDATE,
    LI.RECEIPTDATE,
    LI.SHIPINSTRUCT,
    LI.SHIPMODE,
    S.SUPPLIERNAME,
    S.ADDRESS AS SUPPLIER_ADDRESS,
    S.PHONE AS SUPPLIER_PHONE,
    P.NAME AS PART_NAME,
    P.PARTKEY AS PART_KEY,
    P.MFGR AS PART_MFGR,
    P.BRAND AS PART_BRAND,
    P.TYPE AS PART_TYPE,
    P.SIZE AS PART_SIZE,
    P.CONTAINER AS PART_CONTAINER,
    P.RETAILPRICE AS PART_RETAILPRICE,
    C.CUSTOMER_NAME AS CUSTOMER_NAME,
    C.ADDRESS AS ADDRESS,
    C.PHONE AS PHONE,
    CURRENT_TIMESTAMP AS LOAD_TIMESTAMP
FROM DBT.DBT.DIM_LINEITEM LI
LEFT JOIN DBT.DBT.DIM_SUPPLIER S ON LI.SUPPKEY = S.SUPPLIERKEY
LEFT JOIN DBT.DBT.DIM_PART P ON LI.PARTKEY = P.PARTKEY
LEFT JOIN DBT.DBT.DIM_CUSTOMER C ON LI.SUPPKEY = C.CUSTKEY
  );

